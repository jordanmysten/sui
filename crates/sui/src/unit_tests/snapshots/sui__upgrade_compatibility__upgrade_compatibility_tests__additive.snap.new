---
source: crates/sui/src/unit_tests/upgrade_compatibility_tests.rs
assertion_line: 67
expression: normalize_path(err.to_string())
---
error[Compatibility E01005]: missing declaration
  ┌─ /fixtures/upgrade_errors/additive_errors_v2/sources/UpgradeErrors.move:4:18
  │
4 │ module upgrades::upgrades {
  │                  ^^^^^^^^ enum 'EnumToRemove' is missing
  │
  = enum is missing expected enum 'EnumToRemove', but found none
  = enums cannot be changed or removed during an 'additive' or 'dependency only' upgrade.
  = add missing enum 'EnumToRemove' back to the module 'upgrades'.

error[Compatibility E01005]: missing declaration
  ┌─ /fixtures/upgrade_errors/additive_errors_v2/sources/UpgradeErrors.move:4:18
  │
4 │ module upgrades::upgrades {
  │                  ^^^^^^^^ function 'function_to_remove' is missing
  │
  = function is missing expected function 'function_to_remove', but found none
  = functions cannot be changed or removed during an 'additive' or 'dependency only' upgrade.
  = add missing function 'function_to_remove' back to the module 'upgrades'.

error[Compatibility E01005]: missing declaration
  ┌─ /fixtures/upgrade_errors/additive_errors_v2/sources/UpgradeErrors.move:4:18
  │
4 │ module upgrades::upgrades {
  │                  ^^^^^^^^ struct 'StructToRemove' is missing
  │
  = struct is missing expected struct 'StructToRemove', but found none
  = structs cannot be changed or removed during an 'additive' or 'dependency only' upgrade.
  = add missing struct 'StructToRemove' back to the module 'upgrades'.

error[Compatibility E01002]: type mismatch
  ┌─ /fixtures/upgrade_errors/additive_errors_v2/sources/UpgradeErrors.move:7:9
  │
6 │     public struct StructToChange {
  │                   -------------- Struct definition
7 │         new_field: u32 // changed to u32
  │         ^^^^^^^^^ Mismatched field type 'u32', expected 'u64'.
  │
  = Structs are part of a module's public interface and cannot be changed during an upgrade.
  = Restore the original struct's fields for struct 'StructToChange' including the ordering.

error[Compatibility E04001]: function signature mismatch
   ┌─ /Users/jordanjennings/code/sui/crates/sui/src/unit_tests/fixtures/upgrade_errors/additive_errors_v2/sources/UpgradeErrors.move:18:31
   │
18 │     fun function_to_change(): u32 { // changed to u32
   │                               ^^^ Unexpected return type u32, expected u64
   │
   = Functions are part of a module's public interface and cannot be changed during an upgrade.
   = Restore the original function's return types for function 'function_to_change'.


Upgrade failed, this package requires changes to be compatible with the existing package. Its upgrade policy is set to 'Compatible'.
